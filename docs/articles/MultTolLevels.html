<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Different outlier tolerance levels for different O3 plots • OutliersO3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Different outlier tolerance levels for different O3 plots">
<meta property="og:description" content="OutliersO3">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OutliersO3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DrawingO3plots.html">Drawing O3 (Overview Of Outliers) plots</a>
    </li>
    <li>
      <a href="../articles/MultTolLevels.html">Different outlier tolerance levels for different O3 plots</a>
    </li>
    <li>
      <a href="../articles/PCPsO3.html">Drawing additional parallel coordinate plots to support O3 plots</a>
    </li>
    <li>
      <a href="../articles/xtraO3methods.html">Including results from other outlier identification methods in O3 plots</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Different outlier tolerance levels for different O3 plots</h1>
                        <h4 class="author">Antony Unwin</h4>
            
            <h4 class="date">2020-05-18</h4>
      
      
      <div class="hidden name"><code>MultTolLevels.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The outlier methods used in the <em>OutliersO3</em> package identify outliers in different ways. The common key parameter is usually called <code>alpha</code> (<code>alpha.cutoff</code> for <code>adjOutlyingness</code>, <code>tolProb</code> for <code>DDC</code>), although for some methods (<code>FastPCS</code>, <code>DDC</code>, <code>covMcd</code>) it is input as <code>(1-alpha)</code>. <em>OutliersO3</em> uses <code>tol</code> arguments, short for tolerance level, to put all these on an equivalent footing. The alphas (or (1-alpha)’s) are not directly comparable and so they should be set individually when drawing O3 plots to compare results. It is up to users to decide which value should be used for each method.</p>
</div>
<div id="using-individual-tolerance-levels-for-different-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#using-individual-tolerance-levels-for-different-methods" class="anchor"></a>Using individual tolerance levels for different methods</h2>
<p>Figure 1 shows an example using four variables of German demographic data. Applying the default tolerance level values from the help pages of the individual methods, far too many outliers were generated with some of the methods. A little experimentation with the tolerance levels was carried out to reduce these numbers to more manageable ones. (This new set of tolerance levels is the current default in O3prep.)</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">OutliersO3</span>)</pre></body></html></div>
<pre><code>## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">Election2005</span>)
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">Election2005</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">17</span>, <span class="fl">28</span>)]
<span class="no">O3d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3prep.html">O3prep</a></span>(<span class="no">data</span>, <span class="kw">method</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"HDo"</span>, <span class="st">"PCS"</span>, <span class="st">"BAC"</span>, <span class="st">"adjOut"</span>, <span class="st">"DDC"</span>, <span class="st">"MCD"</span>), <span class="kw">tolHDo</span><span class="kw">=</span><span class="fl">0.05</span>, <span class="kw">tolPCS</span><span class="kw">=</span><span class="fl">0.5</span>, <span class="kw">tolBAC</span><span class="kw">=</span><span class="fl">0.95</span>, <span class="kw">toladj</span><span class="kw">=</span><span class="fl">0.25</span>, <span class="kw">tolDDC</span><span class="kw">=</span><span class="fl">0.01</span>, <span class="kw">tolMCD</span><span class="kw">=</span><span class="fl">0.5</span>)
<span class="no">O3d1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3plotM.html">O3plotM</a></span>(<span class="no">O3d</span>)
<span class="no">O3d1</span>$<span class="no">nOut</span></pre></body></html></div>
<pre><code>##    HDo    PCS    BAC adjOut    DDC    MCD 
##     10    293    129     39      4    246</code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">O3p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3prep.html">O3prep</a></span>(<span class="no">data</span>, <span class="kw">method</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"HDo"</span>, <span class="st">"PCS"</span>, <span class="st">"BAC"</span>, <span class="st">"adjOut"</span>, <span class="st">"DDC"</span>, <span class="st">"MCD"</span>))
<span class="no">O3p1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3plotM.html">O3plotM</a></span>(<span class="no">O3p</span>)
<span class="no">O3p1</span>$<span class="no">nOut</span></pre></body></html></div>
<pre><code>##    HDo    PCS    BAC adjOut    DDC    MCD 
##     10     10      5      1      4     11</code></pre>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">O3p1</span>$<span class="no">gO3</span></pre></body></html></div>
<p><img src="MultTolLevels_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;"> Fig 1: An O3 plot displaying outliers found by any of the 6 methods using individually specified <code>tol</code> values. No outlier was identified by all six methods for any combination of variables.</p>
<p>The constituency labelled X84 is the Berlin-Friedrichshain -etc one mentioned in the first vignette. There are 4 variable combinations where it is identified as an outlier by five of the methods. Inspecting the table of outlier cases by variable combinations and methods, <code>outsTable</code>, reveals that the <code>DDC method</code> is the odd man out three times. In fact, it does not really identify any outliers at all, as the 4 ascribed to it all come from the boxplot outlier identification rule that is used for methods which cannot identify outliers for single variables.</p>
<p>It should not be surprising that the methods find different outliers, because they are all different and have different goals, although we might have expected that they all agree on the most extreme outliers. Perhaps the main surprise is that the differences are so great—at least for this dataset.</p>
</div>
<div id="analysing-etymology-data-with-different-tolerance-levels" class="section level2">
<h2 class="hasAnchor">
<a href="#analysing-etymology-data-with-different-tolerance-levels" class="anchor"></a>Analysing etymology data with different tolerance levels</h2>
<p>The etymology dataset from <em>languageR</em> includes 285 Dutch verbs with 13 attributes. Excluding the four factors and three other attributes, potential outliers were identified using the six methods and the same individual tolerance levels as for the example shown in Figure 1.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">etymology</span>, <span class="kw">package</span><span class="kw">=</span><span class="st">"languageR"</span>)
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="no">etymology</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">14</span>)]
<span class="no">O3q</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3prep.html">O3prep</a></span>(<span class="no">data</span>, <span class="kw">method</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"HDo"</span>, <span class="st">"PCS"</span>, <span class="st">"BAC"</span>, <span class="st">"adjOut"</span>, <span class="st">"DDC"</span>, <span class="st">"MCD"</span>), <span class="kw">tolHDo</span><span class="kw">=</span><span class="fl">0.01</span>, <span class="kw">tolPCS</span><span class="kw">=</span><span class="fl">0.005</span>, <span class="kw">tolBAC</span><span class="kw">=</span><span class="fl">0.005</span>, <span class="kw">toladj</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">tolDDC</span><span class="kw">=</span><span class="fl">0.01</span>, <span class="kw">tolMCD</span><span class="kw">=</span><span class="fl">0.000001</span>)
<span class="no">O3q1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3plotM.html">O3plotM</a></span>(<span class="no">O3q</span>)
<span class="no">O3q1</span>$<span class="no">nOut</span></pre></body></html></div>
<pre><code>##    HDo    PCS    BAC adjOut    DDC    MCD 
##     52     12      5      5     16      5</code></pre>
<p><code>HDoutliers</code> identified far too many outliers so the individual outlier output was inspected to find out for which combinations of variables this occurred. (The variable combination labels are a binary coding in the original order of the variables in the dataset.)</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">outHD</span> <span class="kw">&lt;-</span> <span class="no">O3q1</span>$<span class="no">outsTable</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">Method</span><span class="kw">==</span><span class="st">"HDo"</span>) <span class="kw">%&gt;%</span> <span class="fu">group_by</span>(<span class="no">Combination</span>) <span class="kw">%&gt;%</span> <span class="fu">summarise</span>(<span class="kw">num</span><span class="kw">=</span><span class="fu">n</span>()) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">num</span><span class="kw">&gt;</span><span class="fl">5</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">outHD</span>, <span class="kw">row.names</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">Combination</th>
<th align="right">num</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">c010000</td>
<td align="right">42</td>
</tr>
<tr class="even">
<td align="left">c000001</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>The problem clearly lies in the second attribute, MeanBigramFrequency, and not in the tolerance level set. It was decided to ignore the one dimensional combinations by setting k1=2, and leave the tolerance level as it was. Tightening the tolerance levels for the other two methods finding more than a few outliers (<code>FastPCS</code> and <code>DDC</code>) and adding case names for labels led to Figure 2.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">O3r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3prep.html">O3prep</a></span>(<span class="no">data</span>, <span class="kw">method</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"HDo"</span>, <span class="st">"PCS"</span>, <span class="st">"BAC"</span>, <span class="st">"adjOut"</span>, <span class="st">"DDC"</span>, <span class="st">"MCD"</span>), <span class="kw">k1</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">tolHDo</span><span class="kw">=</span><span class="fl">0.01</span>, <span class="kw">tolPCS</span><span class="kw">=</span><span class="fl">0.0025</span>, <span class="kw">tolBAC</span><span class="kw">=</span><span class="fl">0.005</span>, <span class="kw">toladj</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">tolDDC</span><span class="kw">=</span><span class="fl">0.005</span>, <span class="kw">tolMCD</span><span class="kw">=</span><span class="fl">0.000001</span>)
<span class="no">O3r1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/O3plotM.html">O3plotM</a></span>(<span class="no">O3r</span>, <span class="kw">caseNames</span><span class="kw">=</span><span class="no">etymology</span>$<span class="no">Verb</span>)
<span class="no">O3r1</span>$<span class="no">nOut</span></pre></body></html></div>
<pre><code>##    HDo    PCS    BAC adjOut    DDC    MCD 
##      4      6      5      3      4      5</code></pre>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gridExtra</span>)</pre></body></html></div>
<pre><code>## 
## Attaching package: 'gridExtra'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     combine</code></pre>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">O3r1</span>$<span class="no">gO3</span> + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">plot.margin</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>), <span class="st">"cm"</span>)), <span class="no">O3r1</span>$<span class="no">gpcp</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">heights</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">1</span>))</pre></body></html></div>
<p><img src="MultTolLevels_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Fig 2: An O3 plot of the etymology dataset for combinations to 2 to 6 variables. There is little agreement amongst the methods and no agreement anywhere for all six methods together. The parallel coordinate plot does suggest two pairs of potential outliers on single variables, but judging by the O3 plot they would not be identified as outliers in six dimensions.</p>
<p>A full analysis would include a discussion of the verbs with an expert in Dutch linguistics. Statistical methods can be used to identify cases of possible interest and O3 plots and parallel coordinate plots can help indicate why cases are outliers, but subject matter knowledge is essential.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Antony Unwin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
